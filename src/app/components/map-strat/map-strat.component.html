<app-navbar />

<section *ngIf="map" class="relative h-screen w-full bg-cover bg-center"
  [ngStyle]="{ 'background-image': 'url(' + map.splash + ')' }">
  <div class="absolute inset-0 bg-black/60"></div>
  <div class="relative z-10 flex flex-col justify-end h-full p-10 text-white">
    <h1 class="text-5xl font-extrabold leading-tight max-w-4xl">{{ map.displayName }}</h1>
    <div class="grid grid-cols-3 gap-6 mt-12 text-gray-300 text-sm">
      <div>
        <h4 class="uppercase text-xs">Modality</h4>
        <h4 class="font-semibold uppercase text-xs">Competitive</h4>
      </div>
      <div>
        <h4 class="uppercase text-xs">Tactical Description</h4>
        <h4 class="font-semibold">{{ map.tacticalDescription || 'N/A' }}</h4>
      </div>
      <div>
        <h4 class="uppercase text-xs">Coordinates</h4>
        <h4 class="font-semibold">{{ map.coordinates || 'Unknown' }}</h4>
      </div>
    </div>
  </div>
</section>


<div *ngIf="map" class="map-strat-container" style="padding: 100px 0 100px 0;">
  <div class="flex gap-6">
    <!-- Immagine della mappa con markers -->
    <div class="relative">
      <div class="relative w-[600px] h-[600px] bg-gray-900 rounded-lg overflow-hidden">
        <img [src]="map.displayIcon" alt="Piantina {{ map.displayName }}" class="w-full h-full object-contain">

        <!-- Marker sulla mappa (quando seleziono un callout) -->
        <div *ngIf="selectedCallout" class="absolute w-4 h-4 bg-red-500 rounded-full border-2 border-white" [ngStyle]="{
          top: normalizeY(selectedCallout.location.y) + 'px',
          left: normalizeX(selectedCallout.location.x) + 'px'
        }"></div>
      </div>
    </div>

    <!-- Lista callouts -->
    <div class="flex-1">
      <h3 class="text-xl font-semibold mb-2">Callouts</h3>
      <div *ngIf="map.callouts?.length > 0; else noCallouts" class="grid grid-cols-2 gap-2">
        <div *ngFor="let callout of map.callouts" (click)="selectCallout(callout)"
          class="p-2 rounded cursor-pointer hover:bg-gray-500 transition">
          <strong>{{ callout.regionName }}</strong>
          <span class="text-sm text-gray-600 block">{{ callout.superRegionName }}</span>
        </div>
      </div>

      <ng-template #noCallouts>
        <p class="text-gray-500">Nessun callout disponibile per questa mappa.</p>
      </ng-template>
    </div>
  </div>
</div>

<!-- <div class="flex justify-between mt-6">
  <button *ngIf="prevMap" [routerLink]="['/maps-strat', prevMap.uuid]"
    class="px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded">
    ← Prev
  </button>

  <button *ngIf="nextMap" [routerLink]="['/maps-strat', nextMap.uuid]"
    class="px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded ml-auto">
    Next →
  </button>
</div> -->

<div class="grid grid-cols-1 md:grid-cols-2 w-full mt-8 text-white text-center font-bold text-xl">

  <!-- PREV MAP -->
  <a *ngIf="prevMap" [routerLink]="['/maps-strat', prevMap.uuid]"
    class="relative flex items-center justify-center bg-gray-800 hover:bg-gray-700 overflow-hidden h-32 transition group">

    <!-- SOLO TESTO su desktop, immagine su hover -->
    <span class="z-10 hidden md:block transition-opacity duration-300 group-hover:opacity-0">
      ← PREV MAP
    </span>

    <!-- Immagine SEMPRE visibile su mobile, solo su hover su desktop -->
    <img [src]="prevMap.splash" alt="{{ prevMap.displayName }}" class="absolute inset-0 w-full h-full object-cover 
                opacity-100 md:opacity-0 md:group-hover:opacity-100 
                transition duration-300" />

    <!-- Nome mappa -->
    <span class="absolute bottom-2 left-1/2 -translate-x-1/2 text-sm bg-black bg-opacity-70 px-2 py-1 rounded 
                 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition">
                   
      {{ prevMap.displayName }}
    </span>
  </a>

  <!-- NEXT MAP -->
  <a *ngIf="nextMap" [routerLink]="['/maps-strat', nextMap.uuid]"
    class="relative flex items-center justify-center bg-gray-800 hover:bg-gray-700 overflow-hidden h-32 transition group">

    <!-- SOLO TESTO su desktop -->
    <span class="z-10 hidden md:block transition-opacity duration-300 group-hover:opacity-0">
      NEXT MAP →
    </span>

    <!-- Immagine sempre visibile su mobile -->
    <img [src]="nextMap.splash" alt="{{ nextMap.displayName }}" class="absolute inset-0 w-full h-full object-cover 
                opacity-100 md:opacity-0 md:group-hover:opacity-100 
                transition duration-300" />

    <!-- Nome mappa -->
    <span class="absolute bottom-2 left-1/2 -translate-x-1/2 text-sm bg-black bg-opacity-70 px-2 py-1 rounded 
                 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition">
                  
      {{ nextMap.displayName }}
    </span>
  </a>

</div>







<app-footer />